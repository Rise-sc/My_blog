---
title: 热力图绘制
date: 2025-08-06 15:00:00
updated: 2025-08-06 15:00:00
tags:
  - 数据可视化
categories:
  - 数据可视化
description: 使用 Python（NumPy、Matplotlib、Seaborn、mpmath）绘制热力图的完整流程，并展示圆周率小数部分前 600 位的热力图效果。
---
# 热力图绘制

### 使用场景

- **空间分布**  
  人口密度、商圈客流、空气污染分布  
  → 一眼定位热点区域  

- **变量相关性**  
  股票、气象、机器学习特征相关性  
  → 快速发现强相关/弱相关关系  

- **时间规律**  
  网站流量、销售额、呼叫中心话务量  
  → 找出高峰期与低谷期  

- **模式探索**  
  降维数据、聚类结果、模型权重可视化  
  → 识别数据聚集区或异常区  

- **科学与工程**  
  红外热成像、卫星遥感、基因表达量  
  → 高值区域直接高亮，定位异常  

---



###  0. 模块

- **numpy**    # 数组运算，生成矩阵  
- **matplotlib** # 基础绘图库，seaborn 依赖它  
- **seaborn**   # 高级绘图库，简化热力图绘制  
- **mpmath**  # 高精度计算 π（圆周率）  

 

### **1. 准备数据**

- **确定数据来源**：可以是矩阵、二维数组、或者先有一维数据再 reshape, 考虑精度问题。
- **数据必须是二维结构**（`n × m`）。
- 示例：

```
import numpy as np
data = np.random.randint(0, 10, (10, 10))  # 10×10 随机整数矩阵
```

### **2. 选择配色方案（cmap）**

- 不同的配色适合不同类型的数据：
    - **数值高低** → `"YlGnBu"`, `"coolwarm"`, `"RdYlBu_r"`
    - **分类数据** → `"Set1"`, `"tab20"`
    - **炫彩效果** → `"rainbow"`, `"viridis"`
- 在 seaborn 中直接用 `cmap="..."` 指定。

------

### **3. 绘制热力图**

使用 **Seaborn**（推荐，简单好看）：

```
import seaborn as sns
import matplotlib.pyplot as plt

sns.heatmap(data, 
            cmap="YlGnBu",    # 颜色映射
            vmin=0, vmax=9,   # 数值范围（可选）
            annot=False,      # 是否在格子中显示数值
            square=True,      # 保持方形
            cbar=True)        # 显示颜色条

plt.show()

```

### **4. 调整外观**

- **隐藏刻度标签**：

```
sns.heatmap(data, xticklabels=False, yticklabels=False)
```

- **添加标题**：

```
plt.title("我的热力图", fontsize=16)
```

- **颜色条显示范围**：

```
sns.heatmap(data, vmin=0, vmax=9)
```

### **5. 保存结果（可选）**

```
plt.savefig("heatmap.png", dpi=300, bbox_inches="tight")
```



### Demo

```python
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from mpmath import mp

plt.rcParams['font.sans-serif'] = ['SimHei']  # 设置中文字体为黑体
plt.rcParams['axes.unicode_minus'] = False    # 正常显示负号

# ===== 1. 设置参数 =====
total_digits = 600   # 需要的 π 数字个数（小数部分）
rows, cols = 30, 20  # 30×20 = 600

# ===== 2. 获取圆周率前 total_digits 位 =====
mp.dps = total_digits + 5        # 精度稍微多一点
pi_str = str(mp.pi)[2:]          # 去掉整数部分 "3."
digits = [int(d) for d in pi_str[:total_digits]]

# ===== 3. 转成二维矩阵 =====
matrix = np.array(digits).reshape(rows, cols)

# ===== 4. 绘制热力图（带数字） =====
plt.figure(figsize=(10, 8))
sns.heatmap(matrix,
            vmin=0, vmax=9,
            cmap="rainbow",
            annot=True, fmt="d", # 显示数字
            cbar=True,
            square=False,
            xticklabels=False,
            yticklabels=False)

plt.title(f"圆周率小数部分前 {total_digits} 位热力图", fontsize=16)
plt.savefig("pi_heatmap.png", dpi=300, bbox_inches="tight")
plt.show()
```
![](/images/123.png)


